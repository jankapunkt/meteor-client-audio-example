<template name="play">
    <div class="progress" style="height: 20px;">
        {{#with progress current}}
            <div class="progress-bar clickable" role="progressbar" style="width: {{this}}%;" aria-valuenow="{{this}}"
                 aria-valuemin="0" aria-valuemax="100"></div>
        {{/with}}
    </div>
    <p></p>
    <table class="table table-hover outer-border">
        <thead>
        <tr>
            <th>Filename</th>
            <th>Size</th>
            <th class="text-center">Loaded</th>
            <th class="text-center">Cached</th>
            <th class="text-center"></th>
            <th class="text-right">Actions</th>
        </tr>
        </thead>
        <tbody>
        {{#each sounds}}
            {{#with getFile this.fileId}}
                {{log this}}
                <tr class="{{#if isCurrent this._id}}table-primary{{/if}}">

                    <!-- filename -->
                    <td class="font-weight-bold">
                        <span>{{this.name}}</span>
                        <a href class="delete-button" data-target="{{this._id}}">
                            <i class="fa fa-fw fa-trash-o"></i>
                        </a>
                    </td>

                    <!-- file size -->
                    <td class="text-muted">{{toMB this.size}} MB</td>

                    <!-- is loaded into memory using instance.load(fileId) -->
                    <td class="text-center">
                        {{#if loaded this._id}}
                            <i class="fa fa-fw fa-check"></i>
                        {{else}}
                            <a href class="load-button" data-target="{{this._id}}">
                                <i class="fa fa-fw fa-refresh {{#if loading this._id}}fa-spin{{/if}}"></i>
                            </a>
                        {{/if}}
                    </td>

                    <!-- is cached as blob into a local storage -->
                    <td class="text-center">
                        {{#if isCached this.fileId}}
                            <i class="fa fa-fw fa-check"></i>
                        {{else}}
                            <a href class="cache-button" data-target="{{this._id}}">
                                <i class="fa fa-fw fa-refresh"></i>
                            </a>
                        {{/if}}
                    </td>

                    <td class="text-center">
                        <button class="btn btn-sm btn-default download-button" data-target="{{this._id}}">
                            <i class="fa fa-fw fa-download"></i>
                        </button>
                    </td>
                    <td class="text-right">

                        {{#if isCurrent this._id}}
                            {{#if loaded this._id}}
                                <button class="btn btn-sm btn-default stop-button" data-target="{{this._id}}">
                                    <i class="fa fa-fw fa-stop"></i>
                                </button>
                                {{#if isPlaying this._id}}
                                    <button class="btn btn-sm btn-default pause-button" data-target="{{this._id}}">
                                        <i class="fa fa-fw fa-pause"></i>
                                    </button>
                                {{else}}
                                    <button class="btn btn-sm btn-default play-button" data-target="{{this._id}}">
                                        <i class="fa fa-fw fa-play"></i>
                                    </button>
                                {{/if}}
                            {{else}}
                                <button class="btn btn-sm btn-default">
                                    <i class="fa fa-spinner fa-pulse"></i>
                                </button>
                            {{/if}}
                        {{else}}
                            <button class="btn btn-sm btn-default play-button" data-target="{{this._id}}">
                                <i class="fa fa-fw fa-play"></i>
                            </button>
                        {{/if}}
                    </td>
                </tr>
            {{else}}
                <div class="jumbotron">
                    <p>No files in list. Add one to play.</p>
                </div>
            {{/with}}
        {{/each}}
        </tbody>
    </table>
</template>